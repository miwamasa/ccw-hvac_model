# ビルエネルギーシミュレーションアプリ - ユーザーマニュアル

## 目次

1. [はじめに](#1-はじめに)
2. [インストールとセットアップ](#2-インストールとセットアップ)
3. [基本操作](#3-基本操作)
4. [詳細設定](#4-詳細設定)
5. [シミュレーション実行](#5-シミュレーション実行)
6. [結果の分析](#6-結果の分析)
7. [データ管理](#7-データ管理)
8. [トラブルシューティング](#8-トラブルシューティング)
9. [FAQ](#9-faq)
10. [用語集](#10-用語集)

---

## 1. はじめに

### 1.1 本アプリケーションについて

ビルエネルギーシミュレーションアプリは、オフィスビルのエネルギー消費と室内環境を評価するためのツールです。

**主な用途:**
- 新築ビルの省エネ性能評価
- 既存ビルの改修効果予測
- 空調システムの比較検討
- エネルギーコスト試算

**対象ユーザー:**
- 建築設計者
- 設備設計者
- ファシリティマネージャー
- エネルギー管理者

### 1.2 本マニュアルの使い方

このマニュアルは、アプリケーションの使用方法を段階的に説明します。初めて使用する方は、順番に読み進めることをお勧めします。

---

## 2. インストールとセットアップ

### 2.1 システム要件

**最小要件:**
- OS: Windows 10/11, macOS 10.14+, Linux
- CPU: 1GHz以上
- メモリ: 2GB以上
- ディスク空き容量: 100MB以上
- Python: 3.8以上

**推奨要件:**
- CPU: 2GHz以上
- メモリ: 4GB以上
- ディスク空き容量: 500MB以上

### 2.2 インストール手順

#### Windowsの場合

1. **Pythonのインストール**
   - https://www.python.org/downloads/ からダウンロード
   - インストール時に「Add Python to PATH」にチェック

2. **アプリケーションのダウンロード**
   ```cmd
   # コマンドプロンプトを開く
   cd C:\Users\YourName\Documents
   git clone <repository-url>
   cd building-energy-simulation
   ```

3. **依存パッケージのインストール**
   ```cmd
   pip install -r requirements.txt
   ```

#### macOS/Linuxの場合

1. **Pythonの確認**
   ```bash
   python3 --version
   # 3.8以上であることを確認
   ```

2. **アプリケーションのダウンロード**
   ```bash
   cd ~/Documents
   git clone <repository-url>
   cd building-energy-simulation
   ```

3. **仮想環境の作成（推奨）**
   ```bash
   python3 -m venv venv
   source venv/bin/activate
   ```

4. **依存パッケージのインストール**
   ```bash
   pip install -r requirements.txt
   ```

### 2.3 起動確認

```bash
streamlit run app.py
```

ブラウザが自動的に開き、アプリケーションが表示されれば成功です。

---

## 3. 基本操作

### 3.1 画面構成

アプリケーションは以下のような構成になっています：

```
┌─────────────────────────────────────────────┐
│ サイドバー        │ メインエリア           │
│                   │                         │
│ ⚙️ 設定          │ タブ1: 📝 設定         │
│ ├ プリセット選択  │ タブ2: 📊 シミュレーション │
│ ├ 設定ファイル    │ タブ3: 📈 結果         │
│ └ 表示オプション  │ タブ4: 💾 データ       │
│                   │                         │
└─────────────────────────────────────────────┘
```

### 3.2 プリセットを使用した基本的な流れ

#### ステップ1: プリセット選択

1. サイドバーのプリセット選択で「最新オフィス」または「旧式オフィス」を選択
2. 各プリセットには以下の設定が含まれています：

   **最新オフィス:**
   - 高断熱・高気密（壁U値: 0.3 W/m²K）
   - 高効率空調（COP: 4.5）
   - LED照明（8 W/m²）

   **旧式オフィス:**
   - 低断熱（壁U値: 0.8 W/m²K）
   - 低効率空調（COP: 3.0）
   - 蛍光灯（15 W/m²）

#### ステップ2: 設定確認

「設定」タブで、プリセットの内容を確認します。

- **フロア仕様**: 建物の構造と断熱性能
- **設備仕様**: 空調、照明、OA機器の性能
- **月別運用条件**: 気温、湿度、居住者数など

#### ステップ3: シミュレーション実行

1. 「シミュレーション」タブに移動
2. 「🚀 シミュレーション実行」ボタンをクリック
3. 計算が完了すると結果サマリーが表示されます

#### ステップ4: 結果確認

「結果」タブで以下のグラフが表示されます：

- システム比較グラフ
- エネルギー消費量詳細
- 負荷内訳

#### ステップ5: データ保存

「データ」タブで：

- 結果データをテーブル形式で確認
- 「📥 CSVダウンロード」ボタンでファイル保存

---

## 4. 詳細設定

### 4.1 フロア仕様の設定

#### 床面積 [m²]

- **意味**: シミュレーション対象フロアの床面積
- **設定範囲**: 100 ~ 10,000 m²
- **目安**:
  - 小規模オフィス: 300 ~ 500 m²
  - 中規模オフィス: 500 ~ 2,000 m²
  - 大規模オフィス: 2,000 m²以上

#### 天井高 [m]

- **意味**: 床面から天井までの高さ
- **設定範囲**: 2.0 ~ 5.0 m
- **標準値**: 2.7 ~ 3.0 m

#### 壁U値 [W/m²K]

- **意味**: 壁の熱貫流率（小さいほど断熱性能が高い）
- **設定範囲**: 0.1 ~ 2.0 W/m²K
- **目安**:
  - 高断熱: 0.3以下
  - 標準: 0.5 ~ 0.8
  - 低断熱: 1.0以上

#### 窓面積 [m²]

- **意味**: 外壁に設置された窓の総面積
- **設定範囲**: 10 ~ 1,000 m²
- **目安**: 床面積の15 ~ 25%程度

#### 窓U値 [W/m²K]

- **意味**: 窓の熱貫流率
- **設定範囲**: 0.5 ~ 6.0 W/m²K
- **目安**:
  - 高性能Low-E複層ガラス: 1.5以下
  - 複層ガラス: 2.0 ~ 3.0
  - 単板ガラス: 4.0以上

#### 日射熱取得係数 [-]

- **意味**: 窓から室内に入る日射熱の割合
- **設定範囲**: 0.1 ~ 1.0
- **目安**:
  - 日射遮蔽型: 0.3 ~ 0.4
  - 標準: 0.5 ~ 0.6
  - 透過型: 0.7以上

### 4.2 設備仕様の設定

#### 照明電力密度 [W/m²]

- **意味**: 床面積あたりの照明消費電力
- **目安**:
  - LED照明: 6 ~ 10 W/m²
  - Hf蛍光灯: 10 ~ 12 W/m²
  - 一般蛍光灯: 15 ~ 20 W/m²

#### OA機器電力密度 [W/m²]

- **意味**: 床面積あたりのOA機器消費電力
- **目安**:
  - 最新PC・省エネ機器: 10 ~ 12 W/m²
  - 標準PC: 15 ~ 18 W/m²
  - 旧式PC・サーバー多: 20 W/m²以上

#### 全館空調システム

**外調機能力 [kW]**
- フロア全体の外気処理能力
- 目安: 居住者1人あたり2kW程度

**外調機ファン動力 [kW]**
- 外調機の送風機動力
- 目安: 外調機能力の8 ~ 15%

**熱源容量 [kW]**
- チラー・ボイラーの総容量
- 目安: 床面積1m²あたり0.2 ~ 0.4 kW

**熱源COP [-]**
- 熱源機の効率（Coefficient of Performance）
- 目安:
  - 高効率ターボ冷凍機: 5.0以上
  - 標準ターボ冷凍機: 3.5 ~ 4.5
  - 低効率: 3.0以下

#### 個別空調システム

**個別空調容量 [kW]**
- パッケージエアコン等の総容量
- 目安: 床面積1m²あたり0.1 ~ 0.15 kW

**個別空調COP [-]**
- 目安:
  - 高効率インバータ機: 4.0以上
  - 標準機: 3.0 ~ 3.5
  - 旧型機: 2.5以下

**個別空調ファン動力 [kW]**
- 個別機の送風機動力合計
- 目安: 容量の8 ~ 12%

### 4.3 月別運用条件の設定

データエディタで一括編集が可能です。

#### 外気温 [℃]

- 各月の平均外気温度
- 気象庁の地域別平均データを参照

#### 外気湿度 [%]

- 各月の平均相対湿度
- 通常50 ~ 80%の範囲

#### 室温設定 [℃]

- 空調の設定温度
- 推奨値:
  - 冷房期: 26 ~ 28℃
  - 暖房期: 20 ~ 22℃
  - 中間期: 24℃

#### 室内湿度設定 [%]

- 目標相対湿度
- 推奨値: 45 ~ 60%

#### 給気温度 [℃]

- 空調機からの送風温度
- 冷房時: 16 ~ 18℃
- 暖房時: 20 ~ 22℃

#### 居住者数 [人]

- フロアの在室人数
- 時期や曜日による変動を考慮

#### 利用率 [-]

- オフィスの使用率（0.0 ~ 1.0）
- 繁忙期: 0.8 ~ 0.9
- 閑散期: 0.6 ~ 0.7
- 休暇期: 0.3 ~ 0.5

#### 運転時間 [h]

- 月間の空調運転時間
- 計算例:
  - 平日20日 × 10時間 = 200時間/月
  - 休日稼働を含む場合は追加

---

## 5. シミュレーション実行

### 5.1 実行前のチェックリスト

- [ ] 建物仕様が正しく入力されているか
- [ ] 設備仕様が実際の機器性能と整合しているか
- [ ] 月別条件が地域の気候と合っているか
- [ ] 12ヶ月分すべての条件が設定されているか

### 5.2 実行手順

1. 「シミュレーション」タブに移動
2. 設定内容を最終確認
3. 「🚀 シミュレーション実行」ボタンをクリック
4. 計算完了まで待機（通常1秒未満）

### 5.3 結果サマリーの見方

計算完了後、3つの指標が表示されます：

**年間全館空調**
- 全館空調システムの年間エネルギー消費量合計

**年間個別空調**
- 個別空調システムの年間エネルギー消費量合計

**差分（全館 - 個別）**
- 両システムの消費量差
- 正の値: 全館空調の方が多い
- 負の値: 個別空調の方が多い

### 5.4 比較モード

最新オフィスと旧式オフィスを比較する場合：

1. サイドバーで「比較モード」にチェック
2. シミュレーション実行
3. 両ケースが重ねて表示されます

---

## 6. 結果の分析

### 6.1 システム比較グラフ

**読み取り方:**
- 青線: 全館空調システム
- 赤線: 個別空調システム
- 両線の差: システム選択による省エネ効果

**分析のポイント:**
- どの月が消費量が多いか
- どちらのシステムが有利か
- 季節による差の変化

### 6.2 エネルギー消費量詳細グラフ

**全館空調システム（上段）:**
- 淡い青: ファン動力
- 濃い青: 熱源動力
- 積み上げ棒グラフで内訳を表示

**個別空調システム（下段）:**
- 淡い赤: ファン動力
- 濃い赤: 圧縮機動力

**分析のポイント:**
- 搬送動力（ファン）と熱源動力の比率
- 夏季・冬季の消費パターン

### 6.3 負荷内訳グラフ

**顕熱負荷（上段）:**
- 壁貫流熱: 断熱性能の影響
- 窓貫流熱: 窓性能の影響
- 日射熱: 窓の日射遮蔽性能
- 照明: 照明電力密度
- OA機器: OA機器電力密度
- 人体: 居住者数

**潜熱負荷（下段）:**
- 人体: 人数による発生
- 外気: 外気導入による負荷

**分析のポイント:**
- どの要素が支配的か
- 改善すべき箇所の特定
- 季節による変動パターン

---

## 7. データ管理

### 7.1 結果の保存

#### CSV形式での保存

1. 「データ」タブに移動
2. 結果データを確認
3. 「📥 CSVダウンロード」をクリック
4. ファイル名の形式: `building_energy_sim_YYYYMMDD_HHMMSS.csv`

#### CSVファイルの内容

- 月別の全データ
- 負荷内訳
- エネルギー消費量
- 空気線図の状態点

### 7.2 設定の保存

#### 保存手順

1. サイドバーの「💾 保存」ボタンをクリック
2. JSONファイルがダウンロードされます
3. 適切なファイル名をつけて保存
   - 例: `office_building_config_2024.json`

#### 設定ファイルの内容

```json
{
  "floor_spec": { ... },
  "equipment_spec": { ... },
  "monthly_conditions": [ ... ]
}
```

### 7.3 設定の読み込み

#### 読み込み手順

1. サイドバーの「📁 読み込み」ボタンをクリック
2. 保存したJSONファイルを選択
3. 設定が自動的に反映されます
4. 「設定」タブで内容を確認

---

## 8. トラブルシューティング

### 8.1 アプリが起動しない

**症状:**
- `streamlit run app.py`でエラーが出る

**対処法:**
1. Pythonのバージョン確認
   ```bash
   python --version
   # 3.8以上か確認
   ```

2. 依存パッケージの再インストール
   ```bash
   pip install -r requirements.txt --upgrade
   ```

3. 仮想環境の再作成
   ```bash
   rm -rf venv
   python -m venv venv
   source venv/bin/activate
   pip install -r requirements.txt
   ```

### 8.2 計算結果がおかしい

**症状:**
- 負荷が極端に大きい/小さい
- エネルギー消費がゼロになる

**対処法:**
1. 入力値の確認
   - U値の単位が正しいか
   - 面積の単位が正しいか
   - COPが妥当な範囲か

2. 月別条件の確認
   - 外気温が設定されているか
   - 運転時間がゼロでないか

3. プリセットで試す
   - 正常に動作するか確認

### 8.3 グラフが表示されない

**症状:**
- 結果タブでグラフが空白

**対処法:**
1. ブラウザのキャッシュクリア
2. ページの再読み込み（F5）
3. 別のブラウザで試す

### 8.4 CSVが文字化けする

**症状:**
- Excelで開くと日本語が文字化け

**対処法:**
1. Excelの場合
   - 「データ」→「テキストファイル」から開く
   - 「UTF-8」を選択

2. 別のエディタで開く
   - VSCode, Googleスプレッドシートなど

---

## 9. FAQ

### Q1: どのくらいの精度がありますか？

**A:** 本アプリは簡易計算モデルを使用しており、実際の消費量に対して±20%程度の誤差があります。詳細設計や性能保証には、EnergyPlusなどの詳細シミュレーションをお勧めします。

### Q2: 複数フロアの計算はできますか？

**A:** 現バージョンは単一フロアのみ対応しています。複数フロアの場合は、各フロアを個別に計算し、結果を合算してください。

### Q3: 時刻別の計算はできますか？

**A:** 本アプリは月単位の計算のみです。時刻別の詳細な変動を見るには、EnergyPlusなどの時刻別シミュレーションツールを使用してください。

### Q4: 電気料金の計算はできますか？

**A:** 現バージョンでは電気料金計算機能はありません。kWh単価を別途設定して、CSV結果に掛け算することで概算できます。

### Q5: 他の地域の気候データはどこで入手できますか？

**A:** 気象庁の「過去の気象データ」から、地域別の月平均気温・湿度を入手できます。

https://www.data.jma.go.jp/gmd/risk/obsdl/

### Q6: 蓄熱システムは考慮されますか？

**A:** 現バージョンでは蓄熱効果は考慮されていません。蓄熱システムの評価には、時刻別シミュレーションが必要です。

### Q7: 結果を論文や報告書に使えますか？

**A:** はい。ただし、本アプリは簡易計算であることを明記し、用途に応じて詳細シミュレーションとの比較検証を推奨します。

### Q8: カスタマイズは可能ですか？

**A:** はい。Pythonのソースコードが公開されているため、自由にカスタマイズできます。

---

## 10. 用語集

**COP (Coefficient of Performance)**
- 成績係数。空調機の効率を示す指標。
- COP = 冷暖房能力 / 消費電力

**U値 (熱貫流率)**
- 建材の熱の通しやすさを示す指標。単位: W/m²K
- 小さいほど断熱性能が高い

**顕熱 (Sensible Heat)**
- 温度変化に伴う熱量
- 室温を変化させる熱

**潜熱 (Latent Heat)**
- 状態変化（蒸発・凝縮）に伴う熱量
- 湿度を変化させる熱

**日射熱取得係数 (SHGC: Solar Heat Gain Coefficient)**
- 窓から室内に入る日射熱の割合
- 0~1の値で、小さいほど遮蔽性能が高い

**外調機 (AHU: Air Handling Unit)**
- 外気を処理する空調機
- 外気冷房や全熱交換を行う

**エンタルピー (Enthalpy)**
- 空気の持つ熱量の総和（顕熱+潜熱）
- 単位: kJ/kg'

**絶対湿度 (Absolute Humidity)**
- 乾き空気1kgあたりの水蒸気量
- 単位: kg/kg'

**相対湿度 (Relative Humidity)**
- 飽和水蒸気量に対する実際の水蒸気量の比
- 単位: %

---

## 付録: ケーススタディ

### ケース1: 新築オフィスビルの性能評価

**条件:**
- 床面積: 1,500 m²
- 都心部の20階建てビルのワンフロア
- 最新の省エネ基準を満たす

**設定:**
- プリセット「最新オフィス」を使用
- 床面積を1,500 m²に変更

**結果:**
- 年間全館空調: 約130,000 kWh
- 年間個別空調: 約150,000 kWh
- 全館空調の方が約13%省エネ

**考察:**
高効率な全館空調システムにより、個別空調よりも省エネを実現。

### ケース2: 既存ビルの改修効果

**条件:**
- 築30年のオフィスビル
- 窓を高性能ガラスに交換
- 照明をLEDに更新

**比較:**
1. 改修前: 旧式オフィスプリセット
2. 改修後: 窓U値を1.5に、照明を8W/m²に変更

**結果:**
- 改修前: 年間200,000 kWh
- 改修後: 年間155,000 kWh
- 削減率: 約23%

**考察:**
窓と照明の改修により大幅な省エネ効果を確認。

---

**マニュアルのバージョン**: 1.0.0  
**最終更新日**: 2024年11月
